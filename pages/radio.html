<section class="page-panel" data-page="radio" id="page-radio" hidden>
  <div class="page-scroll">
    <div class="settings-page-content">
      <section class="settings-section">
        <p class="settings-section-title">Radio</p>
        <p class="field-subtext">Audio workspace with waveform, channel stack, quality, filters, and layers.</p>

        <div class="settings-field">
          <div class="settings-label-row">
            <span class="settings-label">Waveform Preview</span>
          </div>
          <div class="waveform-preview-wrap">
            <div class="waveform-section">
              <div class="waveform-filters" role="group" aria-label="Waveform channels">
                <label><input type="checkbox" name="waveform-filter" value="music" checked /> Music</label>
                <label><input type="checkbox" name="waveform-filter" value="sfx" checked /> SFX</label>
                <label><input type="checkbox" name="waveform-filter" value="ambient" checked /> Ambient</label>
              </div>
              <div class="waveform-container">
                <div id="waveform" role="img" aria-label="Audio waveform"></div>
                <canvas id="waveform-canvas"></canvas>
              </div>
            </div>
            <div class="waveform-factor-filters" role="radiogroup" aria-label="Waveform factor">
              <label><input type="radio" name="waveform-factor" value="all" checked /> All</label>
              <label><input type="radio" name="waveform-factor" value="beat" /> Beat only</label>
              <label><input type="radio" name="waveform-factor" value="melody" /> Melody</label>
              <label><input type="radio" name="waveform-factor" value="amplitude" /> Amplitude</label>
            </div>
          </div>
        </div>

        <div class="settings-three-column audio-summary-grid">
          <div class="settings-field audio-settings-column">
            <div class="settings-label-row">
              <span class="settings-label">Autoplay</span>
              <button class="settings-reset-btn" type="button" data-reset-setting="musicAutoplay" title="Reset music autoplay">
                <span class="material-symbols-outlined" aria-hidden="true">restart_alt</span>
              </button>
            </div>
            <label class="settings-switch" for="lofi-autoplay">
              <input type="checkbox" id="lofi-autoplay" checked />
              <span class="settings-switch-track" aria-hidden="true"><span class="settings-switch-thumb"></span></span>
              <span class="settings-switch-text">Autoplay music when opening the modal [Space x2]</span>
            </label>
          </div>

          <div class="settings-field audio-settings-column">
            <div class="settings-label-row">
              <span class="settings-label">Persistent Mode</span>
            </div>
            <label class="settings-switch" for="keep-radio-on">
              <input type="checkbox" id="keep-radio-on" />
              <span class="settings-switch-track" aria-hidden="true"><span class="settings-switch-thumb"></span></span>
              <span class="settings-switch-text">Keep Radio on (play in background after closing modal)</span>
            </label>
          </div>

          <div class="settings-field audio-settings-column">
            <div class="settings-label-row">
              <span class="settings-label">SFX</span>
              <button class="settings-reset-btn" type="button" data-reset-setting="sfxMix" title="Reset SFX settings">
                <span class="material-symbols-outlined" aria-hidden="true">restart_alt</span>
              </button>
            </div>
            <label class="settings-label" for="sfx-volume-slider">SFX Volume</label>
            <div class="sfx-volume-row">
              <button class="btn audio-inline-mute-btn" id="sfx-mute-btn" type="button" aria-pressed="false">Mute</button>
              <input class="editor-font-size-slider sfx-volume-slider" id="sfx-volume-slider" type="range" min="0" max="200" step="1" />
              <span class="sfx-volume-value" id="sfx-volume-value">100</span>
              <span class="sfx-volume-max">200</span>
            </div>
            <label class="append-number-wrap settings-checkbox" for="sfx-adaptive-blend">
              <input type="checkbox" id="sfx-adaptive-blend" />
              <span>Adaptive blend <span class="experimental-pill">Experimental</span></span>
            </label>
          </div>
        </div>

        <div class="settings-two-column audio-settings-split">
          <div class="settings-field audio-settings-column audio-channel-column">
            <div class="settings-label-row">
              <p class="audio-settings-subtitle">Channel</p>
              <button class="settings-reset-btn" type="button" data-reset-setting="audioStreamSource" title="Reset music source and station">
                <span class="material-symbols-outlined" aria-hidden="true">restart_alt</span>
              </button>
            </div>
            <div class="settings-segmented" id="audio-stream-source-group" role="tablist" aria-label="Music source">
              <button class="settings-segment-btn" type="button" data-audio-stream-source="lofi">Lo-fi</button>
              <button class="settings-segment-btn" type="button" data-audio-stream-source="radio">Radio</button>
            </div>
            <div class="audio-channel-nav">
              <button class="btn btn-secondary audio-channel-nav-btn audio-channel-nav-btn-icon" id="radio-channel-prev" type="button" aria-label="Previous station" title="Previous station">
                <span class="material-symbols-outlined" aria-hidden="true">chevron_left</span>
              </button>
              <div class="select-wrap settings-select-wrap">
                <select class="field settings-select" id="radio-channel-select"></select>
                <span class="select-icon" aria-hidden="true"></span>
              </div>
              <button class="btn btn-secondary audio-channel-nav-btn audio-channel-nav-btn-icon" id="radio-channel-next" type="button" aria-label="Next station" title="Next station">
                <span class="material-symbols-outlined" aria-hidden="true">chevron_right</span>
              </button>
              <button class="btn btn-secondary audio-channel-nav-btn" id="radio-channel-shuffle" type="button">
                <span class="material-symbols-outlined" aria-hidden="true">shuffle</span>
                <span>Shuffle</span>
              </button>
            </div>
            <div class="settings-inline-actions">
              <button class="btn btn-secondary ai-special-btn" id="radio-learn-ai" type="button">
                <span class="material-symbols-outlined" aria-hidden="true">psychology</span>
                <span>Learn about radio</span>
              </button>
            </div>
            <p class="field-subtext" id="radio-channel-status">Shows live channel health, including ping and buffer.</p>
          </div>

          <div class="settings-field audio-settings-column audio-ambient-section">
            <div class="settings-label-row">
              <p class="audio-settings-subtitle">Ambient Noise</p>
              <button class="settings-reset-btn" type="button" data-reset-setting="ambientNoise" title="Reset ambient noise">
                <span class="material-symbols-outlined" aria-hidden="true">restart_alt</span>
              </button>
            </div>
            <p class="field-subtext">Additive layers that can run together with music/radio.</p>
            <div class="ambient-noise-selector" aria-label="Ambient noise layers">
              <button class="ambient-noise-chip" type="button" data-ambient-track-button="rain" title="Rain">üåßÔ∏è</button>
              <button class="ambient-noise-chip" type="button" data-ambient-track-button="beach" title="Beach Waves">üåä</button>
              <button class="ambient-noise-chip" type="button" data-ambient-track-button="crickets" title="Crickets">ü¶ó</button>
              <button class="ambient-noise-chip" type="button" data-ambient-track-button="thunder" title="Thunder">‚õàÔ∏è</button>
              <button class="ambient-noise-chip" type="button" data-ambient-track-button="city" title="City">üèôÔ∏è</button>
              <button class="ambient-noise-chip" type="button" data-ambient-track-button="white" title="White Noise">üìª</button>
            </div>
            <div class="settings-inline-actions">
              <button class="btn btn-secondary" id="ambient-randomize-btn" type="button" hidden>Randomize Volumes</button>
            </div>
            <div class="ambient-noise-panels">
              <div class="ambient-noise-panel" data-ambient-panel="rain" hidden>
                <div class="ambient-noise-panel-head"><span class="ambient-noise-name">Rain</span></div>
                <div class="ambient-noise-volume-row">
                  <input class="editor-font-size-slider" id="ambient-rain-volume" type="range" min="0" max="100" step="1" />
                  <span class="sfx-volume-value" id="ambient-rain-volume-value">35</span>
                </div>
              </div>
              <div class="ambient-noise-panel" data-ambient-panel="beach" hidden>
                <div class="ambient-noise-panel-head"><span class="ambient-noise-name">Beach Waves</span></div>
                <div class="ambient-noise-volume-row">
                  <input class="editor-font-size-slider" id="ambient-beach-volume" type="range" min="0" max="100" step="1" />
                  <span class="sfx-volume-value" id="ambient-beach-volume-value">35</span>
                </div>
              </div>
              <div class="ambient-noise-panel" data-ambient-panel="crickets" hidden>
                <div class="ambient-noise-panel-head"><span class="ambient-noise-name">Crickets</span></div>
                <div class="ambient-noise-volume-row">
                  <input class="editor-font-size-slider" id="ambient-crickets-volume" type="range" min="0" max="100" step="1" />
                  <span class="sfx-volume-value" id="ambient-crickets-volume-value">35</span>
                </div>
              </div>
              <div class="ambient-noise-panel" data-ambient-panel="thunder" hidden>
                <div class="ambient-noise-panel-head"><span class="ambient-noise-name">Thunder</span></div>
                <div class="ambient-noise-volume-row">
                  <input class="editor-font-size-slider" id="ambient-thunder-volume" type="range" min="0" max="100" step="1" />
                  <span class="sfx-volume-value" id="ambient-thunder-volume-value">35</span>
                </div>
              </div>
              <div class="ambient-noise-panel" data-ambient-panel="city" hidden>
                <div class="ambient-noise-panel-head"><span class="ambient-noise-name">City</span></div>
                <div class="ambient-noise-volume-row">
                  <input class="editor-font-size-slider" id="ambient-city-volume" type="range" min="0" max="100" step="1" />
                  <span class="sfx-volume-value" id="ambient-city-volume-value">35</span>
                </div>
              </div>
              <div class="ambient-noise-panel" data-ambient-panel="white" hidden>
                <div class="ambient-noise-panel-head"><span class="ambient-noise-name">White Noise</span></div>
                <div class="ambient-noise-volume-row">
                  <input class="editor-font-size-slider" id="ambient-white-volume" type="range" min="0" max="100" step="1" />
                  <span class="sfx-volume-value" id="ambient-white-volume-value">35</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="settings-field audio-settings-column audio-radio-pulse-section" id="radio-pulse-section" hidden>
          <div class="settings-label-row">
            <p class="audio-settings-subtitle">Pulse</p>
          </div>
          <div class="settings-conditional-body" id="radio-pulse-controls-body" hidden>
            <label class="settings-label" for="radio-pulse-strength-slider">Pulse strength</label>
            <div class="editor-font-size-row">
              <input class="field editor-font-size-input" id="radio-pulse-strength-input" type="number" min="0" max="200" step="1" inputmode="numeric" />
              <input class="editor-font-size-slider" id="radio-pulse-strength-slider" type="range" min="0" max="200" step="1" />
            </div>
            <p class="field-subtext">How strong the radio pulse can be in Party Mode.</p>
          </div>
        </div>

        <div class="settings-two-column audio-settings-split">
          <div class="settings-field audio-settings-column">
            <div class="settings-label-row">
              <span class="settings-label">Music Quality</span>
              <button class="settings-reset-btn" type="button" data-reset-setting="audioBitrate" title="Reset audio bitrate">
                <span class="material-symbols-outlined" aria-hidden="true">restart_alt</span>
              </button>
            </div>
            <div class="editor-font-size-row">
              <input class="field editor-font-size-input" id="quality-bitrate-input" type="number" min="32" max="320" step="8" inputmode="numeric" />
              <input class="editor-font-size-slider" id="quality-bitrate-slider" type="range" min="32" max="320" step="8" />
            </div>
            <p class="field-subtext" id="quality-bitrate-hz">Approx bandwidth and cutoff are shown in Hz.</p>
          </div>

          <div class="settings-field audio-settings-column">
            <div class="settings-label-row">
              <span class="settings-label">Equalizer</span>
              <button class="settings-reset-btn" type="button" data-reset-setting="equalizer" title="Reset equalizer">
                <span class="material-symbols-outlined" aria-hidden="true">restart_alt</span>
              </button>
            </div>
            <label class="settings-label" for="equalizer-preset-select">Preset</label>
            <div class="select-wrap settings-select-wrap">
              <select class="field settings-select" id="equalizer-preset-select">
                <option value="flat">Flat</option>
                <option value="bass-boost">Bass Boost</option>
                <option value="vocal-boost">Vocal Boost</option>
                <option value="treble-boost">Treble Boost</option>
                <option value="smile">Smile</option>
                <option value="custom">Custom</option>
              </select>
              <span class="select-icon" aria-hidden="true"></span>
            </div>
            <div class="settings-conditional-body" id="equalizer-custom-body">
              <div class="equalizer-vertical-grid">
                <div class="equalizer-band">
                  <label class="equalizer-band-label" for="eq-low-slider">Low</label>
                  <input class="equalizer-vertical-slider" id="eq-low-slider" type="range" min="-12" max="12" step="0.5" />
                  <input class="field equalizer-band-input" id="eq-low-input" type="number" min="-12" max="12" step="0.5" inputmode="decimal" />
                </div>
                <div class="equalizer-band">
                  <label class="equalizer-band-label" for="eq-low-mid-slider">Low Mid</label>
                  <input class="equalizer-vertical-slider" id="eq-low-mid-slider" type="range" min="-12" max="12" step="0.5" />
                  <input class="field equalizer-band-input" id="eq-low-mid-input" type="number" min="-12" max="12" step="0.5" inputmode="decimal" />
                </div>
                <div class="equalizer-band">
                  <label class="equalizer-band-label" for="eq-mid-slider">Mid</label>
                  <input class="equalizer-vertical-slider" id="eq-mid-slider" type="range" min="-12" max="12" step="0.5" />
                  <input class="field equalizer-band-input" id="eq-mid-input" type="number" min="-12" max="12" step="0.5" inputmode="decimal" />
                </div>
                <div class="equalizer-band">
                  <label class="equalizer-band-label" for="eq-high-mid-slider">High Mid</label>
                  <input class="equalizer-vertical-slider" id="eq-high-mid-slider" type="range" min="-12" max="12" step="0.5" />
                  <input class="field equalizer-band-input" id="eq-high-mid-input" type="number" min="-12" max="12" step="0.5" inputmode="decimal" />
                </div>
                <div class="equalizer-band">
                  <label class="equalizer-band-label" for="eq-high-slider">High</label>
                  <input class="equalizer-vertical-slider" id="eq-high-slider" type="range" min="-12" max="12" step="0.5" />
                  <input class="field equalizer-band-input" id="eq-high-input" type="number" min="-12" max="12" step="0.5" inputmode="decimal" />
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="settings-field audio-settings-column">
          <div class="settings-label-row">
            <span class="settings-label">Audio Filters</span>
            <button class="settings-reset-btn" type="button" data-reset-setting="lofi8d" title="Reset audio filters">
              <span class="material-symbols-outlined" aria-hidden="true">restart_alt</span>
            </button>
          </div>
          <label class="settings-switch" for="lofi-8d-enabled">
            <input type="checkbox" id="lofi-8d-enabled" checked />
            <span class="settings-switch-track" aria-hidden="true"><span class="settings-switch-thumb"></span></span>
            <span class="settings-switch-text">8D spatial sweep (current filter)</span>
          </label>
          <div class="settings-conditional-body" id="lofi-8d-controls-body">
            <div class="settings-field">
              <label class="settings-label" for="lofi-8d-rate-slider">8D Sweep Speed</label>
              <div class="editor-font-size-row">
                <input class="field editor-font-size-input" id="lofi-8d-rate-input" type="number" min="0.1" max="4" step="0.1" inputmode="decimal" />
                <input class="editor-font-size-slider" id="lofi-8d-rate-slider" type="range" min="0.1" max="4" step="0.1" />
              </div>
            </div>
          </div>
        </div>

        <div class="settings-field audio-settings-column">
          <div class="settings-label-row">
            <span class="settings-label">Layers <span class="experimental-pill">Experimental</span></span>
          </div>
          <p class="field-subtext">Open the layer editor to prioritize sounds by drag order and left/right distribution.</p>
          <div class="settings-inline-actions">
            <button class="btn btn-secondary" id="audio-layers-open-btn" type="button">Open Layers Modal</button>
          </div>
          <div class="audio-layers-modal-backdrop" id="audio-layers-modal" hidden>
            <div class="audio-layers-modal-card" role="dialog" aria-modal="true" aria-label="Audio layers">
              <div class="settings-label-row">
                <p class="audio-settings-subtitle">Audio Layers</p>
                <button class="settings-reset-btn" id="audio-layers-close-btn" type="button" aria-label="Close audio layers modal">
                  <span class="material-symbols-outlined" aria-hidden="true">close</span>
                </button>
              </div>
              <p class="field-subtext">Drag to reorder priority (top = strongest). Move blocks to distribute left/right.</p>
              <label class="append-number-wrap settings-checkbox audio-layers-use-toggle" for="audio-layers-use-toggle">
                <input type="checkbox" id="audio-layers-use-toggle" />
                <span>Use layers</span>
              </label>
              <label class="append-number-wrap settings-checkbox audio-layers-snap-toggle" for="audio-layers-snap-grid">
                <input type="checkbox" id="audio-layers-snap-grid" checked />
                <span>Snap to grid</span>
              </label>
              <div class="audio-layer-list" id="audio-layers-list"></div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
</section>
